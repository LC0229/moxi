# Moxi å·¥å…·ä½¿ç”¨æŒ‡å—

## ğŸ¯ å·¥å…·çš„ä¸¤ä¸ªé˜¶æ®µ

### é˜¶æ®µ 1: è®­ç»ƒé˜¶æ®µï¼ˆå¼€å‘è€…è‡ªå·±ç”¨ï¼Œä¸€æ¬¡æ€§çš„ï¼‰

**ç›®çš„ï¼š** è®­ç»ƒä¸€ä¸ªä¸“é—¨ç”Ÿæˆæ–‡æ¡£çš„æ¨¡å‹

**æµç¨‹ï¼š**
```
dataset_generator â†’ ç”Ÿæˆè®­ç»ƒæ•°æ® â†’ training_pipeline â†’ è®­ç»ƒæ¨¡å‹
```

**ä½¿ç”¨ï¼š**
```bash
# ç”Ÿæˆè®­ç»ƒæ•°æ®
make generate-training-dataset

# è®­ç»ƒæ¨¡å‹
make train-sft
```

---

### é˜¶æ®µ 2: ä½¿ç”¨é˜¶æ®µï¼ˆç”¨æˆ·ä½¿ç”¨ï¼ŒæŒç»­æ€§çš„ï¼‰

**ç›®çš„ï¼š** ä¸ºç”¨æˆ·ç”Ÿæˆæ–‡æ¡£

**æµç¨‹ï¼š**
```
ç”¨æˆ·ä»“åº“ â†’ repo_analyzer â†’ doc_generator â†’ ç”Ÿæˆæ–‡æ¡£
```

---

## ğŸ“– ç”¨æˆ·ä½¿ç”¨åœºæ™¯ï¼ˆé˜¶æ®µ 2ï¼‰

### åœºæ™¯ 1: å•ä¸ªä»“åº“

#### æ–¹å¼ A: CLI æ‰‹åŠ¨ä½¿ç”¨

```bash
# ç”¨æˆ·æœ‰ä¸€ä¸ªä»“åº“ï¼Œæƒ³ç”Ÿæˆæ–‡æ¡£
moxi generate https://github.com/user/repo

# æµç¨‹ï¼š
# 1. repo_analyzer åˆ†æä»“åº“
# 2. doc_generator ç”Ÿæˆæ–‡æ¡£
# 3. è¾“å‡º README.md
```

**å¤„ç†æ–¹å¼ï¼š**
- ä¸²è¡Œå¤„ç†ï¼ˆå•ä¸ªä»“åº“ï¼Œä¸éœ€è¦å¹¶å‘ï¼‰
- æ—¶é—´ï¼š~10 åˆ†é’Ÿ

---

#### æ–¹å¼ B: GitHub Actions è‡ªåŠ¨è§¦å‘

```yaml
# .github/workflows/auto-docs.yml
name: Auto Update Docs

on:
  push:
    branches: [main]

jobs:
  generate-docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: LC0229/moxi-action@v1
        with:
          repo: ${{ github.repository }}
```

**å¤„ç†æ–¹å¼ï¼š**
- å•ä¸ªä»“åº“ push â†’ è§¦å‘å•ä¸ªæ–‡æ¡£ç”Ÿæˆ
- æ—¶é—´ï¼š~10 åˆ†é’Ÿ

---

### åœºæ™¯ 2: å¤šä¸ªä»“åº“

#### æ–¹å¼ A: CLI æ‰¹é‡ä½¿ç”¨

```bash
# ç”¨æˆ·æœ‰ 20 ä¸ªä»“åº“ï¼Œæƒ³ä¸€æ¬¡æ€§ç”Ÿæˆæ‰€æœ‰æ–‡æ¡£
moxi generate-batch \
  --repos \
    https://github.com/user/repo1 \
    https://github.com/user/repo2 \
    ... \
    https://github.com/user/repo20
```

**å¤„ç†æ–¹å¼ï¼š**
- **å¹¶å‘å¤„ç†**ï¼ˆå±•ç¤ºé«˜å¹¶å‘èƒ½åŠ›ï¼‰
- 20 ä¸ªä»“åº“åŒæ—¶å¤„ç†
- æ—¶é—´ï¼šä¸²è¡Œ 200 åˆ†é’Ÿ â†’ å¹¶å‘ 4 åˆ†é’Ÿï¼ˆ50x æå‡ï¼‰

**å®ç°ï¼š**
```python
# doc_generator/core.py
def generate_batch_docs(repo_urls: list[str], concurrent: bool = True):
    if concurrent:
        # å¹¶å‘å¤„ç†
        with ThreadPoolExecutor(max_workers=20) as executor:
            futures = [executor.submit(generate_single_doc, url) for url in repo_urls]
            return [f.result() for f in futures]
```

---

#### æ–¹å¼ B: GitHub Actions åŒæ—¶è§¦å‘å¤šä¸ªä»“åº“

**æƒ…å†µï¼š**
- ç”¨æˆ· A: ä»“åº“1 push â†’ è§¦å‘æ–‡æ¡£ç”Ÿæˆ
- ç”¨æˆ· A: ä»“åº“2 push â†’ è§¦å‘æ–‡æ¡£ç”Ÿæˆ
- ç”¨æˆ· B: ä»“åº“1 push â†’ è§¦å‘æ–‡æ¡£ç”Ÿæˆ
- ... 50 ä¸ªä»“åº“åŒæ—¶è§¦å‘

**å¤„ç†æ–¹å¼ï¼š**
- **å¹¶å‘å¤„ç†**ï¼ˆå¿…é¡»ï¼å¦åˆ™æ’é˜Ÿç­‰å¾…ï¼‰
- 50 ä¸ªä»“åº“åŒæ—¶å¤„ç†
- æ—¶é—´ï¼šä¸²è¡Œ 500 åˆ†é’Ÿ â†’ å¹¶å‘ 10 åˆ†é’Ÿï¼ˆ50x æå‡ï¼‰

**å®ç°ï¼š**
```python
# å¦‚æœåšæˆ API æœåŠ¡å™¨
@app.post("/generate")
async def generate(repo: str):
    # å•ä¸ªè¯·æ±‚ï¼Œä½†æœåŠ¡å™¨å¯ä»¥å¹¶å‘å¤„ç†å¤šä¸ªè¯·æ±‚
    return generate_single_doc(repo)

# æˆ–è€…ä½¿ç”¨ä»»åŠ¡é˜Ÿåˆ—
# Redis Queue â†’ Workers (å¹¶å‘å¤„ç†)
```

---

#### æ–¹å¼ C: ä¼ä¸šç”¨æˆ·æ‰¹é‡æ›´æ–°

**æƒ…å†µï¼š**
- å…¬å¸æœ‰ 100 ä¸ªä»“åº“
- éœ€è¦æ‰¹é‡æ›´æ–°æ‰€æœ‰æ–‡æ¡£

**å¤„ç†æ–¹å¼ï¼š**
- **å¹¶å‘å¤„ç†**ï¼ˆå¿…é¡»ï¼ï¼‰
- 100 ä¸ªä»“åº“åŒæ—¶å¤„ç†
- æ—¶é—´ï¼šä¸²è¡Œ 16 å°æ—¶ â†’ å¹¶å‘ 20 åˆ†é’Ÿï¼ˆ48x æå‡ï¼‰

---

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹

### å•ä¸ªä»“åº“æµç¨‹

```
ç”¨æˆ·: moxi generate https://github.com/user/repo
    â†“
repo_analyzer.analyze_repository()
    â”œâ”€â”€ å…‹éš†ä»“åº“
    â”œâ”€â”€ åˆ†æç»“æ„
    â””â”€â”€ è¿”å› RepositoryInfo
    â†“
doc_generator.generate_single_doc()
    â”œâ”€â”€ åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹
    â”œâ”€â”€ æ„å»º prompt
    â”œâ”€â”€ æ¨¡å‹ç”Ÿæˆæ–‡æ¡£
    â””â”€â”€ è¾“å‡º README.md
    â†“
å®Œæˆï¼ˆ~10 åˆ†é’Ÿï¼‰
```

---

### å¤šä¸ªä»“åº“æµç¨‹ï¼ˆå¹¶å‘ï¼‰

```
ç”¨æˆ·: moxi generate-batch --repos repo1 repo2 ... repo20
    â†“
doc_generator.generate_batch_docs()
    â”œâ”€â”€ ThreadPoolExecutor(max_workers=20)
    â”œâ”€â”€ å¹¶å‘å¤„ç† 20 ä¸ªä»“åº“
    â””â”€â”€ åŒæ—¶ç”Ÿæˆ 20 ä¸ªæ–‡æ¡£
    â†“
å®Œæˆï¼ˆ~4 åˆ†é’Ÿï¼Œè€Œä¸æ˜¯ 200 åˆ†é’Ÿï¼‰
```

---

## ğŸ“Š é«˜å¹¶å‘å±•ç¤ºåœºæ™¯æ€»ç»“

| åœºæ™¯ | ä»“åº“æ•° | å¤„ç†æ–¹å¼ | æ—¶é—´ï¼ˆä¸²è¡Œï¼‰ | æ—¶é—´ï¼ˆå¹¶å‘ï¼‰ | æå‡ |
|------|--------|----------|--------------|--------------|------|
| å•ä¸ªä»“åº“ | 1 | ä¸²è¡Œ | 10 åˆ†é’Ÿ | 10 åˆ†é’Ÿ | - |
| æ‰¹é‡å¤„ç† | 20 | å¹¶å‘ | 200 åˆ†é’Ÿ | 4 åˆ†é’Ÿ | 50x |
| åŒæ—¶è§¦å‘ | 50 | å¹¶å‘ | 500 åˆ†é’Ÿ | 10 åˆ†é’Ÿ | 50x |
| ä¼ä¸šæ‰¹é‡ | 100 | å¹¶å‘ | 16 å°æ—¶ | 20 åˆ†é’Ÿ | 48x |

---

## ğŸ’¡ å…³é”®ç‚¹

1. **å•ä¸ªä»“åº“ï¼š** ä¸²è¡Œå¤„ç†å³å¯ï¼ˆä¸éœ€è¦å¹¶å‘ï¼‰
2. **å¤šä¸ªä»“åº“ï¼š** å¿…é¡»å¹¶å‘å¤„ç†ï¼ˆå±•ç¤ºé«˜å¹¶å‘èƒ½åŠ›ï¼‰
3. **doc_generator éœ€è¦æ”¯æŒæ‰¹é‡å¹¶å‘**ï¼ˆè¿™æ˜¯ç”¨æˆ·å¯è§çš„åœºæ™¯ï¼‰
4. **dataset_generator çš„å¹¶å‘**ï¼ˆè®­ç»ƒæ•°æ®ç”Ÿæˆï¼Œå¼€å‘è€…è‡ªå·±ç”¨ï¼‰

